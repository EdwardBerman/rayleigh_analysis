# CS 7180: Special Topics in AI Final Project

From yours truly

## Rayleigh Quotient Analysis

### Run Experiments

0. This repository contains a submodule. To run this repository and access the submodule, run `git clone https://github.com/EdwardBerman/rayleigh_analysis.git` followed by `git submodule update --init --recursive`. The repo will require non Pythonic dependencies, you will need to run `sudo apt install cmake gfortran`.
1. Install poetry and run `poetry install`
2. Install wandb via and login via `wandb login [api key]`
3. The longe range graph benchmark can be downloaded by running `python3 -m data_preprocessing.long_range_graph_benchmark`
4. The heat dataset can be generated by running `python3 -m external.hermes.src.data.pde.generate_heat`
5. We generated some heat data with some default settings (i.e. what is in the submodule) and placed it in `data`
6. You can run the training via `python3 -m external.custom_hermes.train dataset=heat backbone=hermes`, this is also in `mesh.sh`
7. Then eval using `eval_mesh.sh` or `python3 -m external.custom_hermes.eval_rollout dataset=heat backbone=hermes model_save_path=model_checkpoints/Heat_Hermes_seed1_model.pt`
8. [Optional] Poke around with the datasets. Run `python3 -m data_preprocessing.homophily` to get the homophily distribution of graphs for the node level classification tasks. 

### Heat diffusion on graphs

1. To generate the heat diffusion data on a graph, do: `python3 -m toy_heat_diffusion.heat_data --density 0.2 --n_sources 5 --minheat 5 --maxheat 15  --num_graphs 10000 --size_mean 50 --size_std 5`
2. To train a GCN on the heat diffusion data on graph, do `python3 -m toy_heat_diffusion.train --data_dir toy_heat_diffusion/data --start_time 0.0 --train_steps 5 --eval_steps 2 --model gcn --layers 12 --hidden 100 --epochs 750`
3. To train the equivalent(ish) Unitary GCN on the heat diffusion data on graph, do `python3 -m toy_heat_diffusion.train --data_dir toy_heat_diffusion/data --start_time 0.0 --train_steps 5 --eval_steps 2 --model gcn --layers 12 --hidden 100 --epochs 750`

To reproduce, install the poetry env and wandb
