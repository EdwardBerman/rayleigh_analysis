# A systematic investigation of oversmoothing in GNNs via the Rayleigh Quotient

From yours truly

## Set Up Instructions

### General

1. This repository contains a submodule. To run this repository and access the submodule, run `git clone https://github.com/EdwardBerman/rayleigh_analysis.git` followed by `git submodule update --init --recursive`. The repo will require non Pythonic dependencies, you will need to run `sudo apt install cmake gfortran`.
2. Install poetry and run `poetry install`
3. Install wandb via and login via `wandb login [api key]`

### Simulation

### PDEs on Meshes

1. The heat and wave datasets can be generated by running `python3 -m external.custom_hermes.generate_heat` and `python3 -m external.custom_hermes.generate_wave`
2. We generated some heat and wave data with some default settings (i.e. what is in the submodule) and placed it in `data`
3. You can run the training via `python3 -m external.custom_hermes.train dataset=heat backbone=hermes`, this is also in `shell_scripts/mesh.sh`. That being said, we use the default Checkpoints supplied from the original Hermes paper for evaluation
4. Models are evaluated using `shell_scripts/eval_mesh.sh` or `python3 -m external.custom_hermes.eval_rollout dataset=heat backbone=hermes model_save_path=model_checkpoints/[model pt file]`

### Long Range Graph Benchmark

1. The longe range graph benchmark can be downloaded by running `python3 -m data_preprocessing.long_range_graph_benchmark`
2. [Optional] Poke around with the datasets. Run `python3 -m data_preprocessing.homophily` to get the homophily distribution of graphs for the node level classification tasks. 
3. Run peptides with [insert here after done]

